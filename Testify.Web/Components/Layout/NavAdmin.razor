<MudPaper Width="100%" Class="d-inline-flex py-3" Elevation="0">
    <MudNavMenu Class="mud-width-full" Color="Color.Primary" Bordered="true">
        <MudText Typo="Typo.h6" Class="px-4">Testify</MudText>
        <MudText Typo="Typo.body2" Class="px-4 mud-text-secondary">@roleTitle</MudText>
        <MudDivider Class="my-2" />
        <MudNavGroup hidden="@showDashboard" Title="Dasboard" Icon="@Icons.Material.Filled.Fort" Expanded="true">
            <MudNavLink Href="/Admin/Home" Icon="@Icons.Material.Filled.Home">Dashboard Admin</MudNavLink>
            <MudNavLink Href="/Examiner/Home" Icon="@Icons.Material.Filled.Home">Dashboard Examiner</MudNavLink>
            <MudNavLink Href="/Student/Home" Icon="@Icons.Material.Filled.Home">Dashboard Student</MudNavLink>
        </MudNavGroup>
        <MudNavLink hidden="@showSchedule" Href="/Examiner/ExamScheduleManagement" Icon="@Icons.Material.Filled.CalendarToday">Quản Lý Lịch Thi</MudNavLink>
        <MudNavLink Href="/Examiner/ClassManagement" Icon="@Icons.Material.Filled.Class">Quản Lý Lớp Học</MudNavLink>
        <MudNavLink hidden="@showAccount" Href="/Examiner/AccountManagement" Icon="@Icons.Material.Filled.ManageAccounts">Quản Lý Tài Khoản</MudNavLink>
        <MudNavGroup hidden="@showExamManagement" Title="Quản lý đề thi" Icon="@Icons.Material.Filled.Article" Expanded="true">
            <MudNavLink Href="/Examiner/ExamManagement" Icon="@Icons.Material.Filled.FilterNone">Bài Thi</MudNavLink>
            <MudNavLink Href="/Examiner/CreateExamDetail" Icon="@Icons.Material.Filled.Iso">Đề thi</MudNavLink>
        </MudNavGroup>

        <MudNavLink hidden="@showSubject" Href="/Examiner/SubjectManagement" Icon="@Icons.Material.Filled.Subject">Quản Lý Môn Học</MudNavLink>
        <MudNavGroup hidden="@showQuestionManagement" Title="Quản lý câu hỏi" Icon="@Icons.Material.Filled.AutoStories" Expanded="true">
            <MudNavLink Href="/Examiner/QuestionManagement" Icon="@Icons.Material.Filled.QuestionAnswer">Câu Hỏi Và Đáp Án</MudNavLink>
            <MudNavLink Href="/Examiner/QuestionLevelManagement" Icon="@Icons.Material.Filled.Calculate">Mức độ câu hỏi</MudNavLink>
        </MudNavGroup>
        <MudNavGroup hidden="@showChart" Title="Phổ điểm" Icon="@Icons.Material.Filled.InsertChartOutlined" Expanded="true">
            <MudNavLink Href="/ScoreDistribution-Exam" Icon="@Icons.Material.Filled.FormatListNumberedRtl">Bài thi</MudNavLink>
            <MudNavLink Href="/ScoreDistribution-Class" Icon="@Icons.Material.Filled.MeetingRoom">Lớp</MudNavLink>
            <MudNavLink Href="/ScoreDistribution-Subject" Icon="@Icons.Material.Filled.MenuBook">Môn</MudNavLink>
        </MudNavGroup>
    </MudNavMenu>
</MudPaper>
@code
{
    private User user = new User();

    private bool showSchedule = false;
    private bool showDashboard = false;
    private bool showClass = false;
    private bool showAccount = false;
    private bool showSubject = false;
    private bool showQuestionManagement = false;
    private bool showQuestionLevel = false;
    private bool showChart = false;
    private bool showExamManagement = false;
    private string roleTitle = "Quản trị";


    protected override async Task OnAfterRenderAsync(bool firstRender)
    {


        var sessionResult = await ProtectedSessionStore.GetAsync<string>("userLogin");
        if (sessionResult.Success && sessionResult.Value != null)
        {

            user = await _serUser.GetByidUser(Guid.Parse(sessionResult.Value.ToString()));
            if (user == null)
            {
                navigation.NavigateTo("/");
            }
            else
            {
                HideElement();
                StateHasChanged();
            }
        }        


    }

    protected override async void OnInitialized()
    {


    }

    private void HideElement()
    {
        if (user.LevelId == 3)
        {
            roleTitle = "Giảng viên";
            showAccount = true;
            showChart = true;
            showSchedule = true;
            showDashboard = true;
            showExamManagement = true;
            showQuestionManagement = true;
            StateHasChanged();
        }
        else if (user.LevelId == 2)
        {
            roleTitle = "Khảo thí";
            showAccount = true;
        }
        else if (user.LevelId == 1)
        {
            roleTitle = "Quản trị";
        }
    }
}